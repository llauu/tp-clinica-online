import{a as le,b as de,c as me,d as ce}from"./chunk-BXSLFMNK.js";import{a as W,b as c,c as X,d as Y,e as V,g as u,i as ee,j as te,k as ie,l as ne,m as re,n as oe,p as ae}from"./chunk-KKKNWOTH.js";import{a as B}from"./chunk-HTSGBBHS.js";import{C as E,D,E as H,F as J,G as K,I as w,J as T,L as Q}from"./chunk-PW2C6INU.js";import{f as Z}from"./chunk-4GSK5XHJ.js";import{$a as s,Ab as z,Ma as a,Na as b,Tb as G,U as M,Z as N,bb as l,ca as j,e as I,gb as A,hb as L,ib as O,jb as r,ka as v,kb as t,la as x,lb as g,ob as y,qb as h,rb as _,s as k,sb as $,tb as m,ub as q,x as R}from"./chunk-ZLKBHWEC.js";function U(e,o){return n=>{let i=n.value;return e.TraerDni(i,o).pipe(R(d=>d?{dniExiste:"El DNI ya esta registrado"}:null))}}var se=(()=>{let o=class o{constructor(i){this.firestore=i}TraerDni(i,d){let p=E(this.firestore,d),C=H(p,J("dni","==",i));return k(K(C)).pipe(R(S=>!S.empty))}};o.\u0275fac=function(d){return new(d||o)(N(T))},o.\u0275prov=M({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();function ue(e,o){e&1&&(r(0,"h2",9),m(1,"Paciente"),t())}function ge(e,o){e&1&&(r(0,"h2",9),m(1,"Especialista"),t())}function ve(e,o){if(e&1){let n=y();r(0,"div",10)(1,"h4",11),m(2,"Como desea registrarse?"),t(),r(3,"div",12)(4,"button",13),h("click",function(){v(n);let d=_();return x(d.configReg("paciente"))}),m(5,"Paciente"),t(),r(6,"button",13),h("click",function(){v(n);let d=_();return x(d.configReg("especialista"))}),m(7,"Especialista"),t()()()}}function xe(e,o){e&1&&(r(0,"p",39),m(1,"El nombre es requerido."),t())}function he(e,o){e&1&&(r(0,"p",39),m(1,"El nombre solo puede contener letras."),t())}function Ee(e,o){if(e&1&&(r(0,"div",38),s(1,xe,2,0,"p",36)(2,he,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.nombre.getError("required")),a(),l("ngIf",n.form.controls.nombre.getError("pattern"))}}function Ce(e,o){e&1&&(r(0,"p",39),m(1,"El apellido es requerido."),t())}function be(e,o){e&1&&(r(0,"p",39),m(1,"El apellido solo puede contener letras."),t())}function ye(e,o){if(e&1&&(r(0,"div",38),s(1,Ce,2,0,"p",36)(2,be,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.apellido.getError("required")),a(),l("ngIf",n.form.controls.apellido.getError("pattern"))}}function Se(e,o){e&1&&(r(0,"p",39),m(1,"El edad es requerida."),t())}function Ie(e,o){if(e&1&&(r(0,"div",38),s(1,Se,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.edad.getError("required"))}}function Re(e,o){e&1&&(r(0,"p",39),m(1,"El DNI es requerido."),t())}function we(e,o){e&1&&(r(0,"p",39),m(1,"El DNI no es valido."),t())}function Te(e,o){if(e&1&&(r(0,"div",38),s(1,Re,2,0,"p",36)(2,we,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.dni.getError("required")),a(),l("ngIf",n.form.controls.dni.getError("pattern"))}}function qe(e,o){e&1&&(r(0,"p",39),m(1,"La obra social es requerida."),t())}function De(e,o){if(e&1&&(r(0,"div",42),s(1,qe,2,0,"p",36),t()),e&2){let n=_(3);a(),l("ngIf",n.form.controls.obraSocial.getError("required"))}}function Ve(e,o){if(e&1&&(r(0,"div",16)(1,"label",40),m(2,"Obra social"),t(),g(3,"input",41),s(4,De,2,1,"div",29),t()),e&2){let n,i=_(2);a(3),l("formControl",i.form.controls.obraSocial),a(),l("ngIf",(n=i.form.get("obraSocial"))==null?null:n.touched)}}function Ue(e,o){if(e&1&&(r(0,"option",45),m(1),t()),e&2){let n=o.$implicit;$("value",n.nombre),a(),q(n.nombre)}}function Fe(e,o){e&1&&(r(0,"p",39),m(1,"La especialidad es requerida."),t())}function Pe(e,o){if(e&1&&(r(0,"div",42),s(1,Fe,2,0,"p",36),t()),e&2){let n=_(3);a(),l("ngIf",n.form.controls.especialidad.getError("required"))}}function ke(e,o){if(e&1&&(r(0,"div",16)(1,"label",43),m(2,"Especialidad"),t(),r(3,"select",44),L(4,Ue,2,2,"option",45,A),t(),s(6,Pe,2,1,"div",29),t()),e&2){let n,i=_(2);a(3),l("formControl",i.form.controls.especialidad),a(),O(i.especialidades),a(2),l("ngIf",(n=i.form.get("especialidad"))==null?null:n.touched)}}function Me(e,o){if(e&1){let n=y();r(0,"div",16)(1,"label",43),m(2,"Agregar especialidad"),t(),r(3,"div",46),g(4,"input",47),r(5,"button",48),h("click",function(){v(n);let d=_(2);return x(d.agregarEspecialidad())}),m(6,"+"),t()()()}}function Ne(e,o){e&1&&(r(0,"p",39),m(1,"El correo es requerido."),t())}function je(e,o){if(e&1&&(r(0,"div",42),s(1,Ne,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.mail.getError("required"))}}function Ae(e,o){e&1&&(r(0,"p",39),m(1,"La contrase\xF1a es requerida."),t())}function Le(e,o){if(e&1&&(r(0,"div",42),s(1,Ae,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.pass.getError("required"))}}function Oe(e,o){e&1&&(r(0,"p",39),m(1,"La contrase\xF1a es requerida."),t())}function $e(e,o){if(e&1&&(r(0,"div",42),s(1,Oe,2,0,"p",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.passRep.getError("required"))}}function ze(e,o){e&1&&(r(0,"label",39),m(1,"La imagen es requerida."),t())}function Ge(e,o){if(e&1&&(r(0,"div",42),s(1,ze,2,0,"label",36),t()),e&2){let n=_(2);a(),l("ngIf",n.form.controls.imagenUno.getError("required"))}}function Ze(e,o){e&1&&(r(0,"p",39),m(1,"La imagen es requerida."),t())}function Be(e,o){if(e&1&&(r(0,"div",42),s(1,Ze,2,0,"p",36),t()),e&2){let n=_(3);a(),l("ngIf",n.form.controls.imagenDos.getError("required"))}}function He(e,o){if(e&1){let n=y();r(0,"div",16)(1,"label",49),m(2,"Imagen dos"),t(),r(3,"input",50),h("change",function(d){v(n);let p=_(2);return x(p.onFileSelected(d,"imagenDos"))}),t(),s(4,Be,2,1,"div",29),t()}if(e&2){let n,i=_(2);a(3),l("formControl",i.form.controls.imagenDos),a(),l("ngIf",(n=i.form.get("imagenDos"))==null?null:n.touched)}}function Je(e,o){if(e&1&&(r(0,"p",39),m(1),t()),e&2){let n=_(2);a(),q(n.errorMsg)}}function Ke(e,o){if(e&1){let n=y();r(0,"div",14)(1,"form",15),h("ngSubmit",function(){v(n);let d=_();return x(d.register())}),r(2,"div",16)(3,"label",17),m(4,"Nombre"),t(),g(5,"input",18),s(6,Ee,3,2,"div",19),t(),r(7,"div",16)(8,"label",20),m(9,"Apellido"),t(),g(10,"input",21),s(11,ye,3,2,"div",19),t(),r(12,"div",16)(13,"label",22),m(14,"Edad"),t(),g(15,"input",23),s(16,Ie,2,1,"div",19),t(),r(17,"div",16)(18,"label",24),m(19,"DNI"),t(),g(20,"input",25),s(21,Te,3,2,"div",19),t(),s(22,Ve,5,2,"div",26)(23,ke,7,2,"div",26)(24,Me,7,0,"div",26),r(25,"div",16)(26,"label",27),m(27,"Correo electronico"),t(),g(28,"input",28),s(29,je,2,1,"div",29),t(),r(30,"div",16)(31,"label",30),m(32,"Contrase\xF1a"),t(),g(33,"input",31),s(34,Le,2,1,"div",29),t(),r(35,"div",16)(36,"label",32),m(37,"Repite contrase\xF1a"),t(),g(38,"input",33),s(39,$e,2,1,"div",29),t(),r(40,"div",16)(41,"label",34),m(42,"Imagen uno"),t(),r(43,"input",35),h("change",function(d){v(n);let p=_();return x(p.onFileSelected(d,"imagenUno"))}),t(),s(44,Ge,2,1,"div",29),t(),s(45,He,5,2,"div",26)(46,Je,2,1,"p",36),r(47,"button",37),m(48,"Dar de alta"),t()()()}if(e&2){let n,i,d,p,C,S,F,P,f=_();a(),l("formGroup",f.form),a(4),l("formControl",f.form.controls.nombre),a(),l("ngIf",(n=f.form.get("nombre"))==null?null:n.touched),a(4),l("formControl",f.form.controls.apellido),a(),l("ngIf",(i=f.form.get("apellido"))==null?null:i.touched),a(4),l("formControl",f.form.controls.edad),a(),l("ngIf",(d=f.form.get("edad"))==null?null:d.touched),a(4),l("formControl",f.form.controls.dni),a(),l("ngIf",(p=f.form.get("dni"))==null?null:p.touched),a(),l("ngIf",f.regPaciente),a(),l("ngIf",!f.regPaciente),a(),l("ngIf",!f.regPaciente),a(4),l("formControl",f.form.controls.mail),a(),l("ngIf",(C=f.form.get("mail"))==null?null:C.touched),a(4),l("formControl",f.form.controls.pass),a(),l("ngIf",(S=f.form.get("pass"))==null?null:S.touched),a(4),l("formControl",f.form.controls.passRep),a(),l("ngIf",(F=f.form.get("passRep"))==null?null:F.touched),a(4),l("formControl",f.form.controls.imagenUno),a(),l("ngIf",(P=f.form.get("imagenUno"))==null?null:P.touched),a(),l("ngIf",f.regPaciente),a(),l("ngIf",f.errorMsg!=""),a(),l("disabled",f.form.invalid)}}var mt=(()=>{let o=class o{constructor(i,d,p,C){this.firestore=i,this.authService=d,this.router=p,this.dniService=C,this.errorMsg="",this.regPaciente=null}ngOnInit(){this.traerEspecialidades()}configReg(i){i=="paciente"?(this.regPaciente=!0,this.form=new V({nombre:new u("",[c.pattern("^[a-zA-Z]+$"),c.required]),apellido:new u("",[c.pattern("^[a-zA-Z]+$"),c.required]),edad:new u("",[c.required,c.min(0),c.max(120)]),dni:new u("",{validators:[c.required,c.pattern("^[0-9]+$")],asyncValidators:U(this.dniService,"pacientes"),updateOn:"blur"}),obraSocial:new u("",[c.required]),mail:new u("",[c.required]),pass:new u("",[c.required]),passRep:new u("",[c.required]),imagenUno:new u("",[c.required]),imagenDos:new u("",[c.required])})):(this.regPaciente=!1,this.form=new V({nombre:new u("",[c.pattern("^[a-zA-Z]+$"),c.required]),apellido:new u("",[c.pattern("^[a-zA-Z]+$"),c.required]),edad:new u("",[c.required,c.min(0),c.max(120)]),dni:new u("",{validators:[c.required,c.pattern("^[0-9]+$")],asyncValidators:U(this.dniService,"especialistas"),updateOn:"blur"}),especialidad:new u("",[c.required]),mail:new u("",[c.required]),pass:new u("",[c.required]),passRep:new u("",[c.required]),imagenUno:new u("",[c.required])}))}onFileSelected(i,d){i.target.files.length>0&&(d==="imagenUno"?this.imagenUno=i.target.files[0]:this.imagenDos=i.target.files[0])}register(){this.form.get("pass").value==this.form.get("passRep").value?this.authService.register(this.form.get("mail").value,this.form.get("pass").value).then(i=>{this.regPaciente?this.user={uid:i.user.uid,nombre:this.form.get("nombre").value,apellido:this.form.get("apellido").value,edad:this.form.get("edad").value,dni:this.form.get("dni").value,rol:"Paciente",obraSocial:this.form.get("obraSocial").value,mail:this.form.get("mail").value,pass:this.form.get("pass").value,imagenUno:"this.imagenUno",imagenDos:"this.imagenDos"}:this.user={uid:i.user.uid,nombre:this.form.get("nombre").value,apellido:this.form.get("apellido").value,edad:this.form.get("edad").value,dni:this.form.get("dni").value,rol:"Especialista",especialidad:this.form.get("especialidad").value,mail:this.form.get("mail").value,pass:this.form.get("pass").value,imagenUno:"this.imagenUno",habilitado:!1},this.addNewUser(this.user),this.router.navigate(["/bienvenida"])}).catch(i=>{switch(i.code){case"auth/invalid-email":this.errorMsg="El correo electronico no es valido.";break;case"auth/missing-password":this.errorMsg="La contrase\xF1a no es valida.";break;case"auth/email-already-in-use":this.errorMsg="El correo electronico ya esta en uso.";break;case"auth/weak-password":this.errorMsg="La contrase\xF1a debe tener al menos 6 caracteres.";break}}):console.log("Las contrase\xF1as no coinciden.")}addNewUser(i){return I(this,null,function*(){if(i.rol=="Paciente"){i.imagenUno=yield this.saveImage(this.imagenUno,i.uid+"/imagenUno"),i.imagenDos=yield this.saveImage(this.imagenDos,i.uid+"/imagenDos");let d=E(D(),"pacientes");w(d,i).then(p=>{console.log(p.id)})}else if(i.rol=="Especialista"){i.imagenUno=yield this.saveImage(this.imagenUno,i.uid+"/imagenUno");let d=E(D(),"especialistas");w(d,i)}})}saveImage(i,d){return I(this,null,function*(){let p=me(ce(),d);return yield le(p,i),yield de(p)})}traerEspecialidades(){return I(this,null,function*(){let i=E(this.firestore,"especialidades");Q(i).subscribe(p=>{this.especialidades=p})})}agregarEspecialidad(){let i=document.getElementById("nuevaEspecialidad");if(i.value!=""&&this.verificarEspecialidad(i.value)){let d=E(this.firestore,"especialidades");w(d,{nombre:i.value}),this.form.patchValue({especialidad:i.value})}}verificarEspecialidad(i){return this.especialidades.find(p=>p.nombre===i)?(this.form.patchValue({especialidad:i}),!1):!0}};o.\u0275fac=function(d){return new(d||o)(b(T),b(B),b(Z),b(se))},o.\u0275cmp=j({type:o,selectors:[["app-registro"]],standalone:!0,features:[z],decls:11,vars:4,consts:[[1,"container"],[1,"row","justify-content-center"],[1,"col-md-6","reg-container","card-top"],[1,"card","shadow","mt-5"],[1,"card-header"],[1,"text-center","mt-3"],["class","text-center",4,"ngIf"],["class","card-body d-flex flex-column justify-content-center align-items-center",4,"ngIf"],["class","card-body",4,"ngIf"],[1,"text-center"],[1,"card-body","d-flex","flex-column","justify-content-center","align-items-center"],[1,"mt-4"],[1,"container","d-flex","justify-content-center","my-3"],[1,"btn","btn-primary","col-4","mx-3",3,"click"],[1,"card-body"],[1,"d-flex","justify-content-center","row",3,"ngSubmit","formGroup"],[1,"col-6","my-3"],["for","nombre",1,"form-label"],["type","text","id","nombre",1,"form-control",3,"formControl"],["class","text-danger mt-1",4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido",1,"form-control",3,"formControl"],["for","edad",1,"form-label"],["type","text","id","edad",1,"form-control",3,"formControl"],["for","dni",1,"form-label"],["type","text","id","dni",1,"form-control",3,"formControl"],["class","col-6 my-3",4,"ngIf"],["for","mail",1,"form-label"],["type","text","id","mail",1,"form-control",3,"formControl"],["class","text-danger",4,"ngIf"],["for","pass",1,"form-label"],["type","text","id","pass",1,"form-control",3,"formControl"],["for","passRep",1,"form-label"],["type","text","id","passRep",1,"form-control",3,"formControl"],["for","foto1",1,"form-label"],["type","file","id","foto1",1,"form-control",3,"change","formControl"],["class","error-msg",4,"ngIf"],["type","submit",1,"btn","btn-primary","mt-5","mb-3","col-10",3,"disabled"],[1,"text-danger","mt-1"],[1,"error-msg"],["for","obraSocial",1,"form-label"],["type","text","id","obraSocial",1,"form-control",3,"formControl"],[1,"text-danger"],["for","especialidad",1,"form-label"],["name","especialidad","id","especialidad",1,"form-control",3,"formControl"],[3,"value"],[1,"row"],["type","text","id","nuevaEspecialidad",1,"form-control","w-50","ms-3"],["type","button",1,"btn","btn-primary","w-25","ms-3",3,"click"],["for","foto2",1,"form-label"],["type","file","id","foto2",1,"form-control",3,"change","formControl"]],template:function(d,p){d&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),m(6,"Registro "),t(),s(7,ue,2,0,"h2",6)(8,ge,2,0,"h2",6),t(),s(9,ve,8,0,"div",7)(10,Ke,49,23,"div",8),t()()()()),d&2&&(a(7),l("ngIf",p.regPaciente),a(),l("ngIf",p.regPaciente==!1),a(),l("ngIf",p.regPaciente==null),a(),l("ngIf",p.regPaciente!=null))},dependencies:[ae,ee,re,oe,W,ne,X,Y,te,ie,G],styles:[".error-msg[_ngcontent-%COMP%]{position:absolute;font-size:15px;margin:0}.card-header[_ngcontent-%COMP%]{background-color:#e4e4e4;border:none}.card-top[_ngcontent-%COMP%]{margin-top:80px}"]});let e=o;return e})();export{mt as RegistroComponent};
